2025-05-09 20:09:47,605 - root - INFO - 配置: {'EXPERIMENT_DIR': 'output\\20250509_200939', 'OUTPUT_DIR': './output', 'DATA_DIR': './datasets', 'BATCH_SIZE': 8, 'NUM_EPOCHS': 3, 'LEARNING_RATE': 0.0001, 'DEVICE': 'cuda'}
2025-05-09 20:09:47,635 - root - INFO - 使用设备: cuda
2025-05-09 20:09:47,636 - root - INFO - 加载RNA-FM模型...
2025-05-09 20:09:48,782 - root - INFO - RNA-FM模型加载完成
2025-05-09 20:09:48,782 - root - INFO - 创建数据集，从目录: ./datasets
2025-05-09 20:09:48,783 - data.dataset - INFO - 找到1个pkl文件
2025-05-09 20:09:48,784 - data.dataset - INFO - 找到 1 个数据文件
2025-05-09 20:09:49,155 - data.dataset - INFO - 检测到训练字典格式: Training_Dict_single.pkl
2025-05-09 20:09:49,218 - data.adapters - INFO - 跳过多链RNA: 1hmh
2025-05-09 20:09:49,226 - data.adapters - INFO - 跳过多链RNA: 1mme
2025-05-09 20:09:49,256 - data.adapters - INFO - 跳过多链RNA: 1biv
2025-05-09 20:09:49,284 - data.adapters - INFO - 跳过多链RNA: 1etf
2025-05-09 20:09:49,323 - data.adapters - INFO - 跳过多链RNA: 1zdi
2025-05-09 20:09:49,361 - data.adapters - INFO - 跳过多链RNA: 1ull
2025-05-09 20:09:49,361 - data.adapters - INFO - 跳过多链RNA: 1kis
2025-05-09 20:09:49,362 - data.adapters - INFO - 跳过多链RNA: 1kis
2025-05-09 20:09:49,430 - data.adapters - INFO - 跳过多链RNA: 1aud
2025-05-09 20:09:49,440 - data.adapters - INFO - 跳过多链RNA: 1a4t
2025-05-09 20:09:49,502 - data.adapters - INFO - 跳过多链RNA: 1a1t
2025-05-09 20:09:49,503 - data.adapters - INFO - 跳过多链RNA: 1a9n
2025-05-09 20:09:49,533 - data.adapters - INFO - 跳过多链RNA: 7msf
2025-05-09 20:09:49,533 - data.adapters - INFO - 跳过多链RNA: 5msf
2025-05-09 20:09:49,549 - data.adapters - INFO - 跳过多链RNA: 1zdk
2025-05-09 20:09:49,582 - data.adapters - INFO - 跳过多链RNA: 1hvu
2025-05-09 20:09:49,594 - data.adapters - INFO - 跳过多链RNA: 2bj2
2025-05-09 20:09:49,594 - data.adapters - INFO - 跳过多链RNA: 2bj2
2025-05-09 20:09:49,610 - data.adapters - INFO - 跳过多链RNA: 1qfq
2025-05-09 20:09:49,622 - data.adapters - INFO - 跳过多链RNA: 1bau
2025-05-09 20:09:49,672 - data.adapters - INFO - 跳过多链RNA: 484d
2025-05-09 20:09:49,672 - data.adapters - INFO - 跳过多链RNA: 1d6k
2025-05-09 20:09:49,672 - data.adapters - INFO - 跳过多链RNA: 1eiy
2025-05-09 20:09:49,679 - data.adapters - INFO - 跳过多链RNA: 1exy
2025-05-09 20:09:49,701 - data.adapters - INFO - 跳过多链RNA: 1euq
2025-05-09 20:09:49,714 - data.adapters - INFO - 跳过多链RNA: 1ffk
2025-05-09 20:09:49,714 - data.adapters - INFO - 跳过多链RNA: 1ekz
2025-05-09 20:09:49,715 - data.adapters - INFO - 跳过多链RNA: 1f5u
2025-05-09 20:09:49,764 - data.adapters - INFO - 跳过多链RNA: 1foq
2025-05-09 20:09:49,765 - data.adapters - INFO - 跳过多链RNA: 1fje
2025-05-09 20:09:49,790 - data.adapters - INFO - 跳过多链RNA: 1g70
2025-05-09 20:09:49,791 - data.adapters - INFO - 跳过多链RNA: 1e7k
2025-05-09 20:09:49,836 - data.adapters - INFO - 跳过多链RNA: 1ibm
2025-05-09 20:09:49,923 - data.adapters - INFO - 跳过多链RNA: 1k9w
2025-05-09 20:09:50,000 - data.adapters - INFO - 跳过多链RNA: 1l1c
2025-05-09 20:09:50,063 - data.adapters - INFO - 跳过多链RNA: 1ls2
2025-05-09 20:09:50,129 - data.adapters - INFO - 跳过多链RNA: 1n34
2025-05-09 20:09:50,265 - data.adapters - INFO - 跳过多链RNA: 1nyb
2025-05-09 20:09:50,277 - data.adapters - INFO - 跳过多链RNA: 1p6v
2025-05-09 20:09:50,277 - data.adapters - INFO - 跳过多链RNA: 1p6v
2025-05-09 20:09:50,321 - data.adapters - INFO - 跳过多链RNA: 1qzc
2025-05-09 20:09:50,351 - data.adapters - INFO - 跳过多链RNA: 1r2w
2025-05-09 20:09:50,368 - data.adapters - INFO - 跳过多链RNA: 1qzc
2025-05-09 20:09:50,544 - data.adapters - INFO - 跳过多链RNA: 1ry1
2025-05-09 20:09:50,600 - data.adapters - INFO - 跳过多链RNA: 1t4l
2025-05-09 20:09:50,702 - data.adapters - INFO - 跳过多链RNA: 1y1y
2025-05-09 20:09:50,813 - data.adapters - INFO - 跳过多链RNA: 1u63
2025-05-09 20:09:50,814 - data.adapters - INFO - 跳过多链RNA: 1zc8
2025-05-09 20:09:50,814 - data.adapters - INFO - 跳过多链RNA: 1zc8
2025-05-09 20:09:50,814 - data.adapters - INFO - 跳过多链RNA: 1zc8
2025-05-09 20:09:50,815 - data.adapters - INFO - 跳过多链RNA: 1zc8
2025-05-09 20:09:50,815 - data.adapters - INFO - 跳过多链RNA: 1zc8
2025-05-09 20:09:50,815 - data.adapters - INFO - 跳过多链RNA: 1zc8
2025-05-09 20:09:50,824 - data.adapters - INFO - 跳过多链RNA: 1x18
2025-05-09 20:09:50,824 - data.adapters - INFO - 跳过多链RNA: 1x18
2025-05-09 20:09:50,824 - data.adapters - INFO - 跳过多链RNA: 1x18
2025-05-09 20:09:50,846 - data.adapters - INFO - 跳过多链RNA: 1zn1
2025-05-09 20:09:50,870 - data.adapters - INFO - 跳过多链RNA: 1ysh
2025-05-09 20:09:50,870 - data.adapters - INFO - 跳过多链RNA: 1ysh
2025-05-09 20:09:50,870 - data.adapters - INFO - 跳过多链RNA: 1ysh
2025-05-09 20:09:50,885 - data.adapters - INFO - 跳过多链RNA: 2adt
2025-05-09 20:09:50,885 - data.adapters - INFO - 跳过多链RNA: 1wz2
2025-05-09 20:09:51,035 - data.adapters - INFO - 跳过多链RNA: 2d19
2025-05-09 20:09:51,035 - data.adapters - INFO - 跳过多链RNA: 2d1b
2025-05-09 20:09:51,053 - data.adapters - INFO - 跳过多链RNA: 2b6g
2025-05-09 20:09:51,053 - data.adapters - INFO - 跳过多链RNA: 2ese
2025-05-09 20:09:51,053 - data.adapters - INFO - 跳过多链RNA: 2f4x
2025-05-09 20:09:51,072 - data.adapters - INFO - 跳过多链RNA: 2bq5
2025-05-09 20:09:51,072 - data.adapters - INFO - 跳过多链RNA: 2bs0
2025-05-09 20:09:51,072 - data.adapters - INFO - 跳过多链RNA: 2bq5
2025-05-09 20:09:51,072 - data.adapters - INFO - 跳过多链RNA: 2bs0
2025-05-09 20:09:51,084 - data.adapters - INFO - 跳过多链RNA: 2b2e
2025-05-09 20:09:51,084 - data.adapters - INFO - 跳过多链RNA: 2b2e
2025-05-09 20:09:51,084 - data.adapters - INFO - 跳过多链RNA: 2go5
2025-05-09 20:09:51,084 - data.adapters - INFO - 跳过多链RNA: 2go5
2025-05-09 20:09:51,139 - data.adapters - INFO - 跳过多链RNA: 2ake
2025-05-09 20:09:51,139 - data.adapters - INFO - 跳过多链RNA: 2dr2
2025-05-09 20:09:51,139 - data.adapters - INFO - 跳过多链RNA: 2agn
2025-05-09 20:09:51,139 - data.adapters - INFO - 跳过多链RNA: 2agn
2025-05-09 20:09:51,140 - data.adapters - INFO - 跳过多链RNA: 2izn
2025-05-09 20:09:51,140 - data.adapters - INFO - 跳过多链RNA: 2iz8
2025-05-09 20:09:51,140 - data.adapters - INFO - 跳过多链RNA: 2iz8
2025-05-09 20:09:51,140 - data.adapters - INFO - 跳过多链RNA: 2hgh
2025-05-09 20:09:51,156 - data.adapters - INFO - 跳过多链RNA: 2der
2025-05-09 20:09:51,158 - data.adapters - INFO - 跳过多链RNA: 2det
2025-05-09 20:09:51,193 - data.adapters - INFO - 跳过多链RNA: 1zbh
2025-05-09 20:09:51,220 - data.adapters - INFO - 跳过多链RNA: 2iy3
2025-05-09 20:09:51,221 - data.adapters - INFO - 跳过多链RNA: 2j28
2025-05-09 20:09:51,221 - data.adapters - INFO - 跳过多链RNA: 2j37
2025-05-09 20:09:51,221 - data.adapters - INFO - 跳过多链RNA: 2j28
2025-05-09 20:09:51,221 - data.adapters - INFO - 跳过多链RNA: 2noq
2025-05-09 20:09:51,221 - data.adapters - INFO - 跳过多链RNA: 2noq
2025-05-09 20:09:51,222 - data.adapters - INFO - 跳过多链RNA: 2noq
2025-05-09 20:09:51,242 - data.adapters - INFO - 跳过多链RNA: 2ihx
2025-05-09 20:09:51,242 - data.adapters - INFO - 跳过多链RNA: 2ob7
2025-05-09 20:09:51,242 - data.adapters - INFO - 跳过多链RNA: 2fy1
2025-05-09 20:09:51,253 - data.adapters - INFO - 跳过多链RNA: 2il9
2025-05-09 20:09:51,254 - data.adapters - INFO - 跳过多链RNA: 2il9
2025-05-09 20:09:51,266 - data.adapters - INFO - 跳过多链RNA: 2du5
2025-05-09 20:09:51,266 - data.adapters - INFO - 跳过多链RNA: 2du4
2025-05-09 20:09:51,267 - data.adapters - INFO - 跳过多链RNA: 2du6
2025-05-09 20:09:51,309 - data.adapters - INFO - 跳过多链RNA: 2pcw
2025-05-09 20:09:51,309 - data.adapters - INFO - 跳过多链RNA: 2nr0
2025-05-09 20:09:51,309 - data.adapters - INFO - 跳过多链RNA: 2nr0
2025-05-09 20:09:51,309 - data.adapters - INFO - 跳过多链RNA: 2nr0
2025-05-09 20:09:51,310 - data.adapters - INFO - 跳过多链RNA: 2nr0
2025-05-09 20:09:51,314 - data.adapters - INFO - 跳过多链RNA: 2izm
2025-05-09 20:09:51,323 - data.adapters - INFO - 跳过多链RNA: 2jpp
2025-05-09 20:09:51,375 - data.adapters - INFO - 跳过多链RNA: 2om3
2025-05-09 20:09:51,375 - data.adapters - INFO - 跳过多链RNA: 2pn9
2025-05-09 20:09:51,385 - data.adapters - INFO - 跳过多链RNA: 2r93
2025-05-09 20:09:51,401 - data.adapters - INFO - 跳过多链RNA: 2om7
2025-05-09 20:09:51,401 - data.adapters - INFO - 跳过多链RNA: 2om7
2025-05-09 20:09:51,401 - data.adapters - INFO - 跳过多链RNA: 2om7
2025-05-09 20:09:51,401 - data.adapters - INFO - 跳过多链RNA: 2om7
2025-05-09 20:09:51,402 - data.adapters - INFO - 跳过多链RNA: 2om7
2025-05-09 20:09:51,402 - data.adapters - INFO - 跳过多链RNA: 2om7
2025-05-09 20:09:51,402 - data.adapters - INFO - 跳过多链RNA: 2om7
2025-05-09 20:09:51,413 - data.adapters - INFO - 跳过多链RNA: 2r1g
2025-05-09 20:09:51,413 - data.adapters - INFO - 跳过多链RNA: 2r1g
2025-05-09 20:09:51,413 - data.adapters - INFO - 跳过多链RNA: 2r1g
2025-05-09 20:09:51,413 - data.adapters - INFO - 跳过多链RNA: 2r1g
2025-05-09 20:09:51,413 - data.adapters - INFO - 跳过多链RNA: 2r1g
2025-05-09 20:09:51,414 - data.adapters - INFO - 跳过多链RNA: 2r1g
2025-05-09 20:09:51,425 - data.adapters - INFO - 适配转换: 原始数据 285 项 -> 适配后 161 项
2025-05-09 20:09:51,426 - data.dataset - INFO - 适配处理成功: 161 个样本
2025-05-09 20:09:51,426 - data.dataset - INFO - 数据加载完成: 总计 161 个样本
2025-05-09 20:09:51,603 - data.dataset - INFO - 数据已缓存到: ./output\cache\processed_data.pt
2025-05-09 20:09:51,604 - data.dataset - INFO - 成功加载161个RNA样本
2025-05-09 20:09:51,604 - root - INFO - 创建数据加载器...
2025-05-09 20:09:51,604 - data.dataset - INFO - 数据集大小: 161
2025-05-09 20:09:51,604 - data.dataset - INFO - 数据集划分: 训练集=128, 验证集=16, 测试集=17
2025-05-09 20:09:51,605 - root - INFO - 创建扭转角预测模型...
2025-05-09 20:09:51,605 - models.torsion_predictor - INFO - 使用提供的RNA-FM模型
2025-05-09 20:09:51,606 - models.torsion_predictor - INFO - RNA-FM参数已冻结
2025-05-09 20:09:51,772 - root - INFO - 开始训练，共3个epoch
2025-05-09 20:10:38,419 - root - INFO - Epoch 1/3, Batch 10/16, Loss: 5.0574
2025-05-09 20:10:40,192 - root - INFO - Epoch 1/3 训练完成，耗时: 48.42秒, 平均损失: 5.0959
2025-05-09 20:11:27,336 - root - INFO - Epoch 1/3 验证完成，平均损失: 3.1722
2025-05-09 20:11:27,342 - models.torsion_predictor - INFO - 模型已保存到 output\20250509_200939\checkpoints\best_model.pth
2025-05-09 20:11:27,343 - root - INFO - 最佳模型已保存，验证损失: 3.1722
2025-05-09 20:12:13,923 - root - INFO - Epoch 2/3, Batch 10/16, Loss: 2.6240
2025-05-09 20:12:15,695 - root - INFO - Epoch 2/3 训练完成，耗时: 48.35秒, 平均损失: 2.9432
2025-05-09 20:13:03,009 - root - INFO - Epoch 2/3 验证完成，平均损失: 1.9814
2025-05-09 20:13:03,014 - models.torsion_predictor - INFO - 模型已保存到 output\20250509_200939\checkpoints\best_model.pth
2025-05-09 20:13:03,014 - root - INFO - 最佳模型已保存，验证损失: 1.9814
2025-05-09 20:13:49,680 - root - INFO - Epoch 3/3, Batch 10/16, Loss: 2.8241
2025-05-09 20:13:51,451 - root - INFO - Epoch 3/3 训练完成，耗时: 48.44秒, 平均损失: 2.5703
2025-05-09 20:14:41,425 - root - INFO - Epoch 3/3 验证完成，平均损失: 1.9162
2025-05-09 20:14:41,431 - models.torsion_predictor - INFO - 模型已保存到 output\20250509_200939\checkpoints\best_model.pth
2025-05-09 20:14:41,431 - root - INFO - 最佳模型已保存，验证损失: 1.9162
2025-05-09 20:14:41,431 - root - INFO - 训练完成
2025-05-09 20:14:41,432 - root - INFO - 加载最佳模型并在测试集上评估...
2025-05-09 20:14:41,457 - models.torsion_predictor - INFO - 从 output\20250509_200939\checkpoints\best_model.pth 加载了模型
2025-05-09 20:14:41,458 - models.torsion_predictor - INFO - 加载了扭转角类型: ['alpha', 'beta', 'gamma', 'delta', 'epsilon', 'zeta', 'chi']
